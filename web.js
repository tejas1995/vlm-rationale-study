(()=>{"use strict";var t=!1,e=[];let n=-1,i=null,s=null,o=null,r=null,u=0,a=0;function l(t){s=t,$("#button_answeronly_usertrusts").attr("disabled","true"),$("#button_answeronly_userdistrusts").attr("disabled","true"),$("#button_answeronly_userunsure").attr("disabled","true"),0==t?$("#button_answeronly_usertrusts").attr("activedecision","true"):1==t?$("#button_answeronly_userdistrusts").attr("activedecision","true"):2==t&&$("#button_answeronly_userunsure").attr("activedecision","true"),$("#ai_explanation_div").show()}function d(t){o=t,$("#button_withexplanation_usertrusts").attr("disabled","true"),$("#button_withexplanation_userdistrusts").attr("disabled","true"),$("#button_withexplanation_userunsure").attr("disabled","true"),0==t?$("#button_withexplanation_usertrusts").attr("activedecision","true"):1==t?$("#button_withexplanation_userdistrusts").attr("activedecision","true"):2==t&&$("#button_withexplanation_userunsure").attr("activedecision","true"),$("#ai_explanation_quality_div").show()}function _(t){r=t,$("#button_withexplanationquality_usertrusts").attr("disabled","true"),$("#button_withexplanationquality_userdistrusts").attr("disabled","true"),$("#button_withexplanationquality_userunsure").attr("disabled","true"),0==t?$("#button_withexplanationquality_usertrusts").attr("activedecision","true"):1==t?$("#button_withexplanationquality_userdistrusts").attr("activedecision","true"):2==t&&$("#button_withexplanationquality_userunsure").attr("activedecision","true"),$("#button_next").show(),$("#button_next").removeAttr("disabled")}function c(t){u+=t,0==u?$("#button_instructions_prev").attr("disabled","true"):$("#button_instructions_prev").removeAttr("disabled"),u>=6?($("#instructions_and_decorations").show(),$("#button_instructions_next").val("Start study")):($("#instructions_and_decorations").hide(),$("#button_instructions_next").val("Next")),1==u&&($("#instructions_and_decorations").show(),$("#main_box_instructions").hide(),$("#main_box_experiment").show(),b()),$("#main_box_instructions").children(":not(input)").each(((t,e)=>{$(e).hide()})),$(`#instructions_${u}`).show()}function b(){if($("#button_readytoanswer").removeAttr("activedecision"),$("#button_readytoanswer").removeAttr("disabled"),$("#button_readytoanswer").show(),$("#button_answeronly_usertrusts").removeAttr("activedecision"),$("#button_answeronly_usertrusts").removeAttr("disabled"),$("#button_answeronly_userdistrusts").removeAttr("activedecision"),$("#button_answeronly_userdistrusts").removeAttr("disabled"),$("#button_answeronly_userunsure").removeAttr("activedecision"),$("#button_answeronly_userunsure").removeAttr("disabled"),$("#button_withexplanation_usertrusts").removeAttr("activedecision"),$("#button_withexplanation_usertrusts").removeAttr("disabled"),$("#button_withexplanation_userdistrusts").removeAttr("activedecision"),$("#button_withexplanation_userdistrusts").removeAttr("disabled"),$("#button_withexplanation_userunsure").removeAttr("activedecision"),$("#button_withexplanation_userunsure").removeAttr("disabled"),$("#button_withexplanationquality_usertrusts").removeAttr("activedecision"),$("#button_withexplanationquality_usertrusts").removeAttr("disabled"),$("#button_withexplanationquality_userdistrusts").removeAttr("activedecision"),$("#button_withexplanationquality_userdistrusts").removeAttr("disabled"),$("#button_withexplanationquality_userunsure").removeAttr("activedecision"),$("#button_withexplanationquality_userunsure").removeAttr("disabled"),$("#ai_explanation_div").hide(),$("#ai_explanation_quality_div").hide(),$("#button_next").hide(),$("#button_quit").hide(),n+=1,n>=e.length)return $("#main_box_experiment").hide(),void(t?($("#reward_box_mock").text(`Your total reward is $${(0).toFixed(2)} (${n+1} questions answered).`),$("#reward_box_mock").show(),$("#main_box_end_mock").show()):($("#reward_box").text(`Your total reward is $${(0).toFixed(2)} (${n+1} questions answered).`),$("#reward_box").show(),$("#main_box_end").show()));i=e[n],$("#question_span").html(i.question),$("#ai_prediction_span").html(i.predicted_answer),$("#ai_explanation_span").html(i.generated_rationale);let s=Math.round(100*i["visual fidelity"]);$("#explanation_fidelity_span").html(`${s}%`);let o=Math.round(100*i.contrastiveness);$("#explanation_contrastiveness_span").html(`${o}%`),$("#progress").text(`Progress: ${n+1} / ${e.length}`)}document.getElementById("button_answeronly_usertrusts")?.addEventListener("click",(()=>l(0))),document.getElementById("button_answeronly_userdistrusts")?.addEventListener("click",(()=>l(1))),document.getElementById("button_answeronly_userunsure")?.addEventListener("click",(()=>l(2))),document.getElementById("button_withexplanation_usertrusts")?.addEventListener("click",(()=>d(0))),document.getElementById("button_withexplanation_userdistrusts")?.addEventListener("click",(()=>d(1))),document.getElementById("button_withexplanation_userunsure")?.addEventListener("click",(()=>d(2))),document.getElementById("button_withexplanationquality_usertrusts")?.addEventListener("click",(()=>_(0))),document.getElementById("button_withexplanationquality_userdistrusts")?.addEventListener("click",(()=>_(1))),document.getElementById("button_withexplanationquality_userunsure")?.addEventListener("click",(()=>_(2))),$("#button_instructions_next").on("click",(()=>c(1))),$("#button_instructions_prev").on("click",(()=>c(-1))),$("#button_next").on("click",(()=>{if(-1!=n){let t={question_i:n};t.question=i,t.count_exited_page=a,a=0}b()}));const h=new URLSearchParams(window.location.search),w=h.get("start"),m=h.get("uid");if(globalThis.url_data=function(t){const e={};for(const[n,i]of t)e[n]=i;return e}(h.entries()),null!=m){if(globalThis.uid=m,"prolific_random"==globalThis.uid){let t=`${Math.floor(10*Math.random())}`.padStart(3,"0");globalThis.uid=`${h.get("prolific_queue_name")}_${t}`}}else{let t=null;for(;null==t;)t=prompt("Enter your user id. Please get in touch if you were not assigned an id but wish to participate in this experiment.");globalThis.uid=t}globalThis.url_data.session_id.startsWith("demo")&&(t=!0),console.log("Running with UID",globalThis.uid),async function(){return await $.getJSON(`baked_queues/${globalThis.uid}.json?t=${Date.now()}`)}().catch((t=>{console.log("Invalid user id."),console.log(globalThis.uid),window.location.reload()})).then((t=>{e=t,null!=w&&(n=parseInt(w)-1,console.log("Starting from",n)),c(0),$("#main_box_instructions").show(),$("#instructions_and_decorations").hide()})),console.log("Starting session with UID:",globalThis.uid);let v=!1;document.onvisibilitychange=()=>{v||(a+=1,v=!0,v=!1)}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFXTyxJQUFNUixFQUNLLG1CQUFsQkMsV0FBV08sSUFBMEIsQ0FDckMsSUFBSUMsRUFBVyxHQUFHeEIsS0FBS3lCLE1BQXNCLEdBQWhCekIsS0FBSzBCLFlBQWlCQyxTQUFTLEVBQUcsS0FDL0RYLFdBQVdPLElBQU0sR0FBR2YsRUFBVU0sSUFBSSwwQkFBMEJVLEcsTUFJN0QsQ0FDSCxJQUFJSSxFQUFpQixLQUNyQixLQUFvQixNQUFiQSxHQUNIQSxFQUFZQyxPQUFPLHNIQUV2QmIsV0FBV08sSUFBTUssQyxDQU1WWixXQUFXQyxTQUFxQixXQUFFYSxXQUFXLFVBQ3BEN0QsR0FBVyxHQUdmOEQsUUFBUUMsSUFBSSxtQkFBb0JoQixXQUFXTyxLRTNTcENVLGlCQUtILGFBSG1CckQsRUFBRXNELFFBQ2pCLGdCQUFnQmxCLFdBQVdPLGNBQWNZLEtBQUtDLFFBR3RELENGc1NBQyxHQUFZQyxPQUFPQyxJQUVmUixRQUFRQyxJQUFJLG9CQUNaRCxRQUFRQyxJQUFJaEIsV0FBV08sS0FDdkJiLE9BQU9DLFNBQVM2QixRQUFRLElBRTFCQyxNQUFNQyxJQUNKeEUsRUFBT3dFLEVBQ2MsTUFBakI3QixJQUNBMUMsRUFBYXdFLFNBQVM5QixHQUFpQixFQUN2Q2tCLFFBQVFDLElBQUksZ0JBQWlCN0QsSUFHakNlLEVBQWtCLEdBQ2xCTixFQUFFLDBCQUEwQkUsT0FDNUJGLEVBQUUsaUNBQWlDUyxNQUFNLElBRzdDMEMsUUFBUUMsSUFBSSw2QkFBOEJoQixXQUFXTyxLQUVyRCxJQUFJcUIsR0FBZSxFQUNuQnpDLFNBQVMwQyxtQkFBcUIsS0FDckJELElBQ0RuRSxHQUFxQixFQUNyQm1FLEdBQWUsRUFJZkEsR0FBZSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL21haW4udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzLnRzIiwid2VicGFjazovLy8uL3NyYy9jb25uZWN0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgREVWTU9ERSB9IGZyb20gXCIuL2dsb2JhbHNcIlxuZXhwb3J0IHZhciBVSUQ6IHN0cmluZ1xuZXhwb3J0IHZhciBNT0NLTU9ERTogYm9vbGVhbiA9IGZhbHNlXG5pbXBvcnQgeyBsb2FkX2RhdGEsIGxvZ19kYXRhIH0gZnJvbSAnLi9jb25uZWN0b3InXG5pbXBvcnQgeyBwYXJhbXNUb09iamVjdCB9IGZyb20gXCIuL3V0aWxzXCJcblxudmFyIGRhdGE6IGFueVtdID0gW11cbmxldCBxdWVzdGlvbl9pID0gLTFcbmxldCBxdWVzdGlvbjogYW55ID0gbnVsbFxubGV0IHVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seTogbnVtYmVyID0gLTFcbmxldCB1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbjogbnVtYmVyID0gLTFcbmxldCB1c2Vyc2VsZWN0aW9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHk6IG51bWJlciA9IC0xXG5sZXQgYmFsYW5jZSA9IDBcbi8vbGV0IHRpbWVfcXVlc3Rpb25fc3RhcnQ6IG51bWJlclxuLy9sZXQgdGltZV90b19hY2Nlc3NfZXhwbGFuYXRpb246IG51bWJlciA9IC0xXG4vL2xldCB0aW1lX3RvX2FjY2Vzc19zb3VyY2VzOiBudW1iZXIgPSAtMVxuLy9sZXQgdGltZV90b19hY2Nlc3NfaW5kaXZpZHVhbF9zb3VyY2U6IGFueVtdID0gWy0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xXVxuLy9sZXQgdGltZV9maW5hbF9kZWNpc2lvbjogbnVtYmVyID0gLTFcbmxldCBpbnN0cnVjdGlvbl9pOiBudW1iZXIgPSAwXG5sZXQgY291bnRfZXhpdGVkX3BhZ2U6IG51bWJlciA9IDBcblxuZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgbWVzc2FnZSkge1xuICAgIGlmICghY29uZGl0aW9uKSB7XG4gICAgICAgIHRocm93IG1lc3NhZ2UgfHwgXCJBc3NlcnRpb24gZmFpbGVkXCI7XG4gICAgfVxufVxuXG5mdW5jdGlvbiByZWdpc3RlckFuc3dlck9ubHlVc2VyU2VsZWN0aW9uKHVzZXJfY2hvaWNlOiBudW1iZXIpIHtcbiAgICB1c2Vyc2VsZWN0aW9uX2Fuc3dlcm9ubHkgPSB1c2VyX2Nob2ljZVxuXG4gICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VydHJ1c3RzXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJkaXN0cnVzdHNcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnVuc3VyZVwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgaWYgKHVzZXJfY2hvaWNlID09IDApIHtcbiAgICAgICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VydHJ1c3RzXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICB9IGVsc2UgaWYgKHVzZXJfY2hvaWNlID09IDEpIHtcbiAgICAgICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VyZGlzdHJ1c3RzXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICB9IGVsc2UgaWYgKHVzZXJfY2hvaWNlID09IDIpIHtcbiAgICAgICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VydW5zdXJlXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICB9XG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl9kaXZcIikuc2hvdygpXG59XG4vLyBFdmVudCBsaXN0ZW5lciBmb3IgdGhlIGJ1dHRvbiBjbGlja1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ0cnVzdHMnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlckFuc3dlck9ubHlVc2VyU2VsZWN0aW9uKDApKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fYW5zd2Vyb25seV91c2VyZGlzdHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJBbnN3ZXJPbmx5VXNlclNlbGVjdGlvbigxKSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnVuc3VyZScpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyQW5zd2VyT25seVVzZXJTZWxlY3Rpb24oMikpO1xuXG5cbmZ1bmN0aW9uIHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uVXNlclNlbGVjdGlvbih1c2VyX2Nob2ljZTogbnVtYmVyKSB7XG4gICAgdXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb24gPSB1c2VyX2Nob2ljZVxuXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ0cnVzdHNcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VyZGlzdHJ1c3RzXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnVuc3VyZVwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgaWYgKHVzZXJfY2hvaWNlID09IDApIHtcbiAgICAgICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMSkge1xuICAgICAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcmRpc3RydXN0c1wiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gICAgfSBlbHNlIGlmICh1c2VyX2Nob2ljZSA9PSAyKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VydW5zdXJlXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICB9XG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl9xdWFsaXR5X2RpdlwiKS5zaG93KClcbn1cblxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnRydXN0cycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uVXNlclNlbGVjdGlvbigwKSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbl91c2VyZGlzdHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25Vc2VyU2VsZWN0aW9uKDEpKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9uX3VzZXJ1bnN1cmUnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlcldpdGhFeHBsYW5hdGlvblVzZXJTZWxlY3Rpb24oMikpO1xuICBcbmZ1bmN0aW9uIHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uUXVhbGl0eVVzZXJTZWxlY3Rpb24odXNlcl9jaG9pY2U6IG51bWJlcikge1xuICAgIHVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eSA9IHVzZXJfY2hvaWNlXG5cbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ0cnVzdHNcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0c1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydW5zdXJlXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICBpZiAodXNlcl9jaG9pY2UgPT0gMCkge1xuICAgICAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMSkge1xuICAgICAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJkaXN0cnVzdHNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH0gZWxzZSBpZiAodXNlcl9jaG9pY2UgPT0gMikge1xuICAgICAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ1bnN1cmVcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH1cbiAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLnNob3coKVxuICAgICQoXCIjYnV0dG9uX25leHRcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG59XG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydHJ1c3RzJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25RdWFsaXR5VXNlclNlbGVjdGlvbigwKSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0cycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlZ2lzdGVyV2l0aEV4cGxhbmF0aW9uUXVhbGl0eVVzZXJTZWxlY3Rpb24oMSkpO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ1bnN1cmUnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByZWdpc3RlcldpdGhFeHBsYW5hdGlvblF1YWxpdHlVc2VyU2VsZWN0aW9uKDIpKTtcblxuXG5cblxuZnVuY3Rpb24gbmV4dF9pbnN0cnVjdGlvbnMoaW5jcmVtZW50OiBudW1iZXIpIHtcbiAgICBpbnN0cnVjdGlvbl9pICs9IGluY3JlbWVudFxuXG4gICAgaWYgKGluc3RydWN0aW9uX2kgPT0gMCkge1xuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX3ByZXZcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgfVxuICAgIGlmIChpbnN0cnVjdGlvbl9pID49IDYpIHtcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLnNob3coKVxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS52YWwoXCJTdGFydCBzdHVkeVwiKVxuICAgIH0gZWxzZSB7XG4gICAgICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5oaWRlKClcbiAgICAgICAgJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikudmFsKFwiTmV4dFwiKVxuICAgIH1cbiAgICBpZiAoaW5zdHJ1Y3Rpb25faSA9PSAxKSB7XG4gICAgICAgICQoXCIjaW5zdHJ1Y3Rpb25zX2FuZF9kZWNvcmF0aW9uc1wiKS5zaG93KClcbiAgICAgICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuaGlkZSgpXG4gICAgICAgICQoXCIjbWFpbl9ib3hfZXhwZXJpbWVudFwiKS5zaG93KClcbiAgICAgICAgbmV4dF9xdWVzdGlvbigpXG4gICAgfVxuXG4gICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuY2hpbGRyZW4oXCI6bm90KGlucHV0KVwiKS5lYWNoKChfLCBlbCkgPT4ge1xuICAgICAgICAkKGVsKS5oaWRlKClcbiAgICB9KVxuICAgICQoYCNpbnN0cnVjdGlvbnNfJHtpbnN0cnVjdGlvbl9pfWApLnNob3coKVxufVxuJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikub24oXCJjbGlja1wiLCAoKSA9PiBuZXh0X2luc3RydWN0aW9ucygrMSkpXG4kKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5vbihcImNsaWNrXCIsICgpID0+IG5leHRfaW5zdHJ1Y3Rpb25zKC0xKSlcblxuJChcIiNidXR0b25fbmV4dFwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcblxuICAgIC8vbGV0IGd0X2xhYmVsOiBib29sZWFuID0gcXVlc3Rpb24hW1wiZ3RfbGFiZWxcIl1cbiAgICAvL2xldCB1c2VyX2lzX2NvcnJlY3Q6IGJvb2xlYW4gPSBndF9sYWJlbCA9PSBmaW5hbF91c2VyX2RlY2lzaW9uXG4gICAgLy9pZiAodXNlcl9pc19jb3JyZWN0KSB7XG4gICAgLy8gICAgYmFsYW5jZSArPSAwLjFcbiAgICAvL31cblxuICAgIGlmIChxdWVzdGlvbl9pICE9IC0xKSB7XG4gICAgICAgIGxldCBsb2dnZWRfZGF0YSA9IHtcbiAgICAgICAgICAgIFwicXVlc3Rpb25faVwiOiBxdWVzdGlvbl9pLFxuICAgICAgICAgICAgLy9cInVzZXJfYmFsYW5jZV9wb3N0X2ludGVyYWN0aW9uXCI6IGJhbGFuY2UsXG4gICAgICAgICAgICAvL1wiZmluYWxfdXNlcl9kZWNpc2lvblwiOiBmaW5hbF91c2VyX2RlY2lzaW9uLFxuICAgICAgICAgICAgLy9cInVzZXJfaXNfY29ycmVjdFwiOiB1c2VyX2lzX2NvcnJlY3QsXG4gICAgICAgICAgICAvL1wiYWNjZXNzZWRfZXhwbGFuYXRpb25cIjogYWNjZXNzZWRfZXhwbGFuYXRpb24sXG4gICAgICAgICAgICAvL1wiYWNjZXNzZWRfc291cmNlc1wiOiBhY2Nlc3NlZF9zb3VyY2VzLFxuICAgICAgICAgICAgLy9cImFjY2Vzc2VkX2luZGl2aWR1YWxfc291cmNlXCI6IGFjY2Vzc2VkX2luZGl2aWR1YWxfc291cmNlLFxuICAgICAgICB9XG5cbiAgICAgICAgbG9nZ2VkX2RhdGFbJ3F1ZXN0aW9uJ10gPSBxdWVzdGlvblxuICAgICAgICBsb2dnZWRfZGF0YVsnY291bnRfZXhpdGVkX3BhZ2UnXSA9IGNvdW50X2V4aXRlZF9wYWdlXG4gICAgICAgIC8vbG9nX2RhdGEobG9nZ2VkX2RhdGEpXG4gICAgICAgIGNvdW50X2V4aXRlZF9wYWdlID0gMFxuICAgIH1cbiAgICBcblxuICAgIG5leHRfcXVlc3Rpb24oKVxufSk7XG5cblxuXG5mdW5jdGlvbiBzaG93X3Jlc3VsdCgpIHtcblxuXG4gICAgLy9sZXQgYWlfaXNfY29ycmVjdDogYm9vbGVhbiA9IHF1ZXN0aW9uIVtcImxsbV9pc19jb3JyZWN0XCJdXG4gICAgLy9sZXQgbWVzc2FnZSA9IFwiQ29ycmVjdCBhbnN3ZXI6IDxiPk9wdGlvbiBcIiArIGNvcnJlY3Rfb3B0aW9uICsgXCI8L2I+Ljxicj5cIlxuICAgIC8vaWYgKHVzZXJfaXNfY29ycmVjdCkge1xuICAgIC8vICAgIG1lc3NhZ2UgKz0gXCJZb3UgcGlja2VkIE9wdGlvbiBcIiArIGZpbmFsX3VzZXJfZGVjaXNpb24gKyBcIiwgd2hpY2ggd2FzIDxzcGFuIGNsYXNzPSdjb2xvcl9jb3JyZWN0Jz48Yj5jb3JyZWN0PC9iPjwvc3Bhbj4uPGJyPlwiXG4gICAgLy99XG4gICAgLy9lbHNlIHtcbiAgICAvLyAgICBtZXNzYWdlICs9IFwiWW91IHBpY2tlZCBPcHRpb24gXCIgKyBmaW5hbF91c2VyX2RlY2lzaW9uICsgXCIsIHdoaWNoIHdhcyA8c3BhbiBjbGFzcz0nY29sb3JfaW5jb3JyZWN0Jz48Yj5pbmNvcnJlY3Q8L2I+PC9zcGFuPi48YnI+XCJcbiAgICAvL31cbiAgICAvL2lmIChhaV9pc19jb3JyZWN0KSB7XG4gICAgLy8gICAgbWVzc2FnZSArPSBcIlRoZSBBSSBwaWNrZWQgT3B0aW9uIFwiICsgcXVlc3Rpb24hW1wiYWlfcHJlZGljdGlvblwiXSArIFwiLCB3aGljaCB3YXMgPHNwYW4gY2xhc3M9J2NvbG9yX2NvcnJlY3QnPjxiPmNvcnJlY3Q8Yj48L3NwYW4+Ljxicj5cIlxuICAgIC8vfVxuICAgIC8vZWxzZSB7XG4gICAgLy8gICAgbWVzc2FnZSArPSBcIlRoZSBBSSBwaWNrZWQgT3B0aW9uIFwiICsgcXVlc3Rpb24hW1wiYWlfcHJlZGljdGlvblwiXSArIFwiLCB3aGljaCB3YXMgPHNwYW4gY2xhc3M9J2NvbG9yX2luY29ycmVjdCc+PGI+aW5jb3JyZWN0PC9iPjwvc3Bhbj4uPGJyPlwiXG4gICAgLy99XG4gICAgLy9pZiAodXNlcl9pc19jb3JyZWN0KSB7XG4gICAgLy8gICAgbWVzc2FnZSArPSBcIjxzcGFuIGNsYXNzPSdjb2xvcl9jb3JyZWN0Jz48Yj5Zb3UgcmVjZWl2ZSBhIHJld2FyZCBvZiAkMC4xMC48L2I+PC9zcGFuPlwiXG4gICAgLy8gICAgYmFsYW5jZSArPSAwLjFcbiAgICAvL31cbiAgICAvL2Vsc2Uge1xuICAgIC8vICAgIG1lc3NhZ2UgKz0gXCI8c3BhbiBjbGFzcz0nY29sb3JfaW5jb3JyZWN0Jz48Yj5Zb3UgZG8gbm90IHJlY2VpdmUgYW55IHJld2FyZC48L2I+PC9zcGFuPlwiXG4gICAgLy99XG4gICAgLy9tZXNzYWdlICs9IFwiPGJyPlwiXG4gICAgLy9pZiAoc3VjY2Vzcykge1xuICAgIC8vICAgIG1lc3NhZ2UgKz0gYFlvdSBnYWluICQkeyhiZXRfdmFsKmJldF92YWxfcmF0aW8pLnRvRml4ZWQoMil9LmBcbiAgICAvLyAgICBiYWxhbmNlICs9IGJldF92YWwqYmV0X3ZhbF9yYXRpb1xuICAgIC8vfSBlbHNlIHtcbiAgICAvLyAgICBtZXNzYWdlICs9IGBZb3UgbG9zZSAkJHsoYmV0X3ZhbC8xLjApLnRvRml4ZWQoMil9LmBcbiAgICAvLyAgICBiYWxhbmNlIC09IGJldF92YWwvMS4wXG4gICAgLy8gICAgYmFsYW5jZSA9IE1hdGgubWF4KDAsIGJhbGFuY2UpXG4gICAgLy99XG4gICAgLy8kKFwiI2JhbGFuY2VcIikudGV4dChgQmFsYW5jZTogJCR7YmFsYW5jZS50b0ZpeGVkKDIpfSArICQxLjBgKVxuICAgIC8vJChcIiNyZXN1bHRfc3BhblwiKS5odG1sKG1lc3NhZ2UpXG4gICAgLy8vLyQoXCIjYnV0dG9uX25leHRcIikuc2hvdygpXG4gICAgLy8kKFwiI3Jlc3VsdF9zcGFuXCIpLnNob3coKVxuICAgIC8vJChcIiNidXR0b25fcGxhY2VfYmV0XCIpLmhpZGUoKVxuXG4gICAgLy8kKCcjcmFuZ2VfdmFsJykuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxufVxuXG4vLyQoXCIjYnV0dG9uX3BsYWNlX2JldFwiKS5vbihcImNsaWNrXCIsIHNob3dfcmVzdWx0KVxuXG5mdW5jdGlvbiBuZXh0X3F1ZXN0aW9uKCkge1xuICAgIC8vIHJlc3RvcmUgcHJldmlvdXMgc3RhdGUgb2YgVUlcblxuICAgICQoXCIjYnV0dG9uX3JlYWR5dG9hbnN3ZXJcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fcmVhZHl0b2Fuc3dlclwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl9yZWFkeXRvYW5zd2VyXCIpLnNob3coKVxuXG4gICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VydHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJkaXN0cnVzdHNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fYW5zd2Vyb25seV91c2VyZGlzdHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICQoXCIjYnV0dG9uX2Fuc3dlcm9ubHlfdXNlcnVuc3VyZVwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl9hbnN3ZXJvbmx5X3VzZXJ1bnN1cmVcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG5cbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcmRpc3RydXN0c1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcmRpc3RydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnVuc3VyZVwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25fdXNlcnVuc3VyZVwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcblxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcnRydXN0c1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ0cnVzdHNcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VyZGlzdHJ1c3RzXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX3dpdGhleHBsYW5hdGlvbnF1YWxpdHlfdXNlcmRpc3RydXN0c1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5X3VzZXJ1bnN1cmVcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fd2l0aGV4cGxhbmF0aW9ucXVhbGl0eV91c2VydW5zdXJlXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl9kaXZcIikuaGlkZSgpXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl9xdWFsaXR5X2RpdlwiKS5oaWRlKClcblxuXG4gICAgLy90aW1lX3RvX2FjY2Vzc19leHBsYW5hdGlvbiA9IC0xXG4gICAgLy90aW1lX3RvX2FjY2Vzc19zb3VyY2VzID0gLTFcbiAgICAvL3RpbWVfdG9fYWNjZXNzX2luZGl2aWR1YWxfc291cmNlID0gWy0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xXVxuICAgIC8vdGltZV9maW5hbF9kZWNpc2lvbiA9IC0xXG4gICAgXG5cbiAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLmhpZGUoKVxuICAgICQoJyNidXR0b25fcXVpdCcpLmhpZGUoKVxuICAgIC8vJChcIiNyYW5nZV92YWxcIikudmFsKHVzZXJfdHJ1c3QpXG5cbiAgICBxdWVzdGlvbl9pICs9IDFcbiAgICBpZiAocXVlc3Rpb25faSA+PSBkYXRhLmxlbmd0aCkge1xuICAgICAgICAkKFwiI21haW5fYm94X2V4cGVyaW1lbnRcIikuaGlkZSgpXG4gICAgICAgIGlmIChNT0NLTU9ERSkge1xuICAgICAgICAgICAgJCgnI3Jld2FyZF9ib3hfbW9jaycpLnRleHQoYFlvdXIgdG90YWwgcmV3YXJkIGlzICQke2JhbGFuY2UudG9GaXhlZCgyKX0gKCR7cXVlc3Rpb25faSsxfSBxdWVzdGlvbnMgYW5zd2VyZWQpLmApXG4gICAgICAgICAgICAkKCcjcmV3YXJkX2JveF9tb2NrJykuc2hvdygpXG4gICAgICAgICAgICAkKFwiI21haW5fYm94X2VuZF9tb2NrXCIpLnNob3coKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJCgnI3Jld2FyZF9ib3gnKS50ZXh0KGBZb3VyIHRvdGFsIHJld2FyZCBpcyAkJHtiYWxhbmNlLnRvRml4ZWQoMil9ICgke3F1ZXN0aW9uX2krMX0gcXVlc3Rpb25zIGFuc3dlcmVkKS5gKVxuICAgICAgICAgICAgJCgnI3Jld2FyZF9ib3gnKS5zaG93KClcbiAgICAgICAgICAgICQoXCIjbWFpbl9ib3hfZW5kXCIpLnNob3coKVxuICAgICAgICB9XG4gICAgICAgIHJldHVyblxuICAgIH1cbiAgICBxdWVzdGlvbiA9IGRhdGFbcXVlc3Rpb25faV1cblxuICAgICQoXCIjcXVlc3Rpb25fc3BhblwiKS5odG1sKHF1ZXN0aW9uIVtcInF1ZXN0aW9uXCJdKVxuICAgICQoXCIjYWlfcHJlZGljdGlvbl9zcGFuXCIpLmh0bWwocXVlc3Rpb24hW1wicHJlZGljdGVkX2Fuc3dlclwiXSlcbiAgICAkKFwiI2FpX2V4cGxhbmF0aW9uX3NwYW5cIikuaHRtbChxdWVzdGlvbiFbXCJnZW5lcmF0ZWRfcmF0aW9uYWxlXCJdKVxuICAgIGxldCB2aXN1YWxfZmlkZWxpdHlfY29uZiA9IE1hdGgucm91bmQocXVlc3Rpb24hW1widmlzdWFsIGZpZGVsaXR5XCJdICogMTAwKVxuICAgICQoXCIjZXhwbGFuYXRpb25fZmlkZWxpdHlfc3BhblwiKS5odG1sKGAke3Zpc3VhbF9maWRlbGl0eV9jb25mfSVgKVxuICAgIGxldCB2aXN1YWxfY29udHJhc3RpdmVuZXNzX2NvbmYgPSBNYXRoLnJvdW5kKHF1ZXN0aW9uIVtcImNvbnRyYXN0aXZlbmVzc1wiXSAqIDEwMClcbiAgICAkKFwiI2V4cGxhbmF0aW9uX2NvbnRyYXN0aXZlbmVzc19zcGFuXCIpLmh0bWwoYCR7dmlzdWFsX2NvbnRyYXN0aXZlbmVzc19jb25mfSVgKVxuXG5cbiAgICAvLyBzZXQgYmV0IHZhbHVlIHJhdGlvXG4gICAgLy9pZihxdWVzdGlvbi5oYXNPd25Qcm9wZXJ0eShcInJld2FyZF9yYXRpb1wiKSkge1xuICAgIC8vICAgIGxldCBbcmF0aW8xLCByYXRpbzJdID0gcXVlc3Rpb25bXCJyZXdhcmRfcmF0aW9cIl1cbiAgICAvLyAgICByYXRpbzEgPSBOdW1iZXIocmF0aW8xKVxuICAgIC8vICAgIHJhdGlvMiA9IE51bWJlcihyYXRpbzIpXG4gICAgLy8gICAgYmV0X3ZhbF9yYXRpbyA9IHJhdGlvMS9yYXRpbzJcbiAgICAvL30gZWxzZSB7XG4gICAgLy8gICAgYmV0X3ZhbF9yYXRpbyA9IDFcbiAgICAvL31cblxuICAgIC8vdGltZV9xdWVzdGlvbl9zdGFydCA9IERhdGUubm93KClcbiAgICAkKFwiI3Byb2dyZXNzXCIpLnRleHQoYFByb2dyZXNzOiAke3F1ZXN0aW9uX2kgKyAxfSAvICR7ZGF0YS5sZW5ndGh9YClcbn1cblxuLy8gZ2V0IHVzZXIgaWQgYW5kIGxvYWQgcXVldWVcbi8vIHRyeSB0byBzZWUgaWYgc3RhcnQgb3ZlcnJpZGUgd2FzIHBhc3NlZFxuY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcbmNvbnN0IHN0YXJ0T3ZlcnJpZGUgPSB1cmxQYXJhbXMuZ2V0KCdzdGFydCcpO1xuY29uc3QgVUlERnJvbVVSTCA9IHVybFBhcmFtcy5nZXQoXCJ1aWRcIilcbmdsb2JhbFRoaXMudXJsX2RhdGEgPSBwYXJhbXNUb09iamVjdCh1cmxQYXJhbXMuZW50cmllcygpKVxuXG5pZiAoVUlERnJvbVVSTCAhPSBudWxsKSB7XG4gICAgZ2xvYmFsVGhpcy51aWQgPSBVSURGcm9tVVJMIGFzIHN0cmluZ1xuICAgIGlmIChnbG9iYWxUaGlzLnVpZCA9PSBcInByb2xpZmljX3JhbmRvbVwiKSB7XG4gICAgICAgIGxldCBxdWV1ZV9pZCA9IGAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKX1gLnBhZFN0YXJ0KDMsIFwiMFwiKVxuICAgICAgICBnbG9iYWxUaGlzLnVpZCA9IGAke3VybFBhcmFtcy5nZXQoXCJwcm9saWZpY19xdWV1ZV9uYW1lXCIpfV8ke3F1ZXVlX2lkfWBcbiAgICB9XG59IGVsc2UgaWYgKERFVk1PREUpIHtcbiAgICBnbG9iYWxUaGlzLnVpZCA9IFwiZGVtb1wiXG59IGVsc2Uge1xuICAgIGxldCBVSURfbWF5YmU6IGFueSA9IG51bGxcbiAgICB3aGlsZSAoVUlEX21heWJlID09IG51bGwpIHtcbiAgICAgICAgVUlEX21heWJlID0gcHJvbXB0KFwiRW50ZXIgeW91ciB1c2VyIGlkLiBQbGVhc2UgZ2V0IGluIHRvdWNoIGlmIHlvdSB3ZXJlIG5vdCBhc3NpZ25lZCBhbiBpZCBidXQgd2lzaCB0byBwYXJ0aWNpcGF0ZSBpbiB0aGlzIGV4cGVyaW1lbnQuXCIpXG4gICAgfVxuICAgIGdsb2JhbFRoaXMudWlkID0gVUlEX21heWJlIVxufVxuXG4vLyB2ZXJzaW9uIGZvciBwYXBlclxuaWYgKERFVk1PREUpIHtcbiAgICBNT0NLTU9ERSA9IHRydWVcbn0gZWxzZSBpZiAoZ2xvYmFsVGhpcy51cmxfZGF0YVsnc2Vzc2lvbl9pZCddLnN0YXJ0c1dpdGgoXCJkZW1vXCIpKSB7XG4gICAgTU9DS01PREUgPSB0cnVlXG59XG5cbmNvbnNvbGUubG9nKFwiUnVubmluZyB3aXRoIFVJRFwiLCBnbG9iYWxUaGlzLnVpZClcbmxvYWRfZGF0YSgpLmNhdGNoKChfZXJyb3IpID0+IHtcbiAgICAvL2FsZXJ0KFwiSW52YWxpZCB1c2VyIGlkLlwiKVxuICAgIGNvbnNvbGUubG9nKFwiSW52YWxpZCB1c2VyIGlkLlwiKVxuICAgIGNvbnNvbGUubG9nKGdsb2JhbFRoaXMudWlkISlcbiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcbn1cbikudGhlbigobmV3X2RhdGEpID0+IHtcbiAgICBkYXRhID0gbmV3X2RhdGFcbiAgICBpZiAoc3RhcnRPdmVycmlkZSAhPSBudWxsKSB7XG4gICAgICAgIHF1ZXN0aW9uX2kgPSBwYXJzZUludChzdGFydE92ZXJyaWRlKSAtIDFcbiAgICAgICAgY29uc29sZS5sb2coXCJTdGFydGluZyBmcm9tXCIsIHF1ZXN0aW9uX2kpXG4gICAgfVxuICAgIC8vIG5leHRfcXVlc3Rpb24oKVxuICAgIG5leHRfaW5zdHJ1Y3Rpb25zKDApXG4gICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuc2hvdygpXG4gICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLmhpZGUoKVxufSlcblxuY29uc29sZS5sb2coXCJTdGFydGluZyBzZXNzaW9uIHdpdGggVUlEOlwiLCBnbG9iYWxUaGlzLnVpZCEpXG5cbmxldCBhbGVydF9hY3RpdmUgPSBmYWxzZVxuZG9jdW1lbnQub252aXNpYmlsaXR5Y2hhbmdlID0gKCkgPT4ge1xuICAgIGlmICghYWxlcnRfYWN0aXZlKSB7XG4gICAgICAgIGNvdW50X2V4aXRlZF9wYWdlICs9IDFcbiAgICAgICAgYWxlcnRfYWN0aXZlID0gdHJ1ZVxuICAgICAgICAvL2lmICghKGdsb2JhbFRoaXMudWlkIS5zdGFydHNXaXRoKFwiZGVtb1wiKSkpIHtcbiAgICAgICAgLy8gICAgYWxlcnQoXCJQbGVhc2UgZG9uJ3QgbGVhdmUgdGhlIHBhZ2UuIElmIHlvdSBkbyBzbyBhZ2Fpbiwgd2UgbWF5IHJlc3RyaWN0IHBheWluZyB5b3UuXCIpXG4gICAgICAgIC8vfVxuICAgICAgICBhbGVydF9hY3RpdmUgPSBmYWxzZVxuICAgIH1cbn0iLCJmdW5jdGlvbiBwYXJhbXNUb09iamVjdChlbnRyaWVzKSB7XG4gIGNvbnN0IHJlc3VsdCA9IHt9XG4gIC8vIGVhY2ggJ2VudHJ5JyBpcyBhIFtrZXksIHZhbHVlXSB0dXBwbGVcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgZW50cmllcykge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IHsgcGFyYW1zVG9PYmplY3QgfSIsImltcG9ydCB7IERFVk1PREUgfSBmcm9tICcuL2dsb2JhbHMnXG5pbXBvcnQgeyBNT0NLTU9ERSB9IGZyb20gJy4vbWFpbidcblxubGV0IFNFUlZFUl9MT0dfUk9PVCA9IERFVk1PREUgPyBcImh0dHA6Ly8xMjcuMC4wLjE6NTAwMC9cIiA6IFwiaHR0cHM6Ly90ZWphc3NyaW5pdmFzYW4ucHl0aG9uYW55d2hlcmUuY29tL1wiXG5cbmFzeW5jIGZ1bmN0aW9uIHNsZWVwKG1zOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWRfZGF0YSgpOiBQcm9taXNlPGFueT4ge1xuICAgIC8vIGluY2x1ZGUgdGltZXN0YW1wIHNvIHRoYXQgdGhpbmdzIGRvbid0IGdldCBjYWNoZWRcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgJC5nZXRKU09OKFxuICAgICAgICBgYmFrZWRfcXVldWVzLyR7Z2xvYmFsVGhpcy51aWR9Lmpzb24/dD0ke0RhdGUubm93KCl9YCxcbiAgICApXG4gICAgcmV0dXJuIHJlc3VsdFxufVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ19kYXRhKGRhdGEpOiBQcm9taXNlPGFueT4ge1xuICAgIC8vaWYgKE1PQ0tNT0RFKSB7XG4gICAgLy8gICAgY29uc29sZS5sb2coXCJsb2dnZWQgKG1vY2spXCIsIGRhdGEpXG4gICAgLy8gICAgcmV0dXJuXG4gICAgLy99XG4gICAgXG4gICAgZGF0YVtcInVybF9kYXRhXCJdID0gZ2xvYmFsVGhpcy51cmxfZGF0YVxuICAgIGNvbnNvbGUubG9nKFwiRGF0YVwiKVxuICAgIGlmICghKFwic3R1ZHlfaWRcIiBpbiBkYXRhWyd1cmxfZGF0YSddKSkge1xuICAgICAgICBkYXRhWyd1cmxfZGF0YSddW1wic3R1ZHlfaWRcIl0gPSBcInRyaWFscnVuX3N0dWRpZXNcIlxuICAgIH1cbiAgICBkYXRhW1widXJsX2RhdGFcIl1bXCJxdWV1ZV9pZFwiXSA9IGdsb2JhbFRoaXMudWlkXG4gICAgY29uc29sZS5sb2coXCJsb2dnZWRcIiwgZGF0YSlcbiAgICBjb25zb2xlLmxvZyhcIkxvZ2dpbmcgdG9cIiwgU0VSVkVSX0xPR19ST09UICsgXCJsb2dcIilcblxuICAgIHRyeSB7XG4gICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCAkLmFqYXgoXG4gICAgICAgICAgICBTRVJWRVJfTE9HX1JPT1QgKyBcImxvZ1wiLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdDogXCJsbG0tdHJ1c3Qtc3R1ZHkvXCIrZGF0YVsndXJsX2RhdGEnXVsnc3R1ZHlfaWQnXSxcbiAgICAgICAgICAgICAgICAgICAgdWlkOiBnbG9iYWxUaGlzLnVpZCtcIl9cIitkYXRhWyd1cmxfZGF0YSddWydwcm9saWZpY19pZCddLFxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkOiBKU09OLnN0cmluZ2lmeShkYXRhKSxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgICBhd2FpdCBzbGVlcCgyMDAwKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICB9XG59Il0sIm5hbWVzIjpbIk1PQ0tNT0RFIiwiZGF0YSIsInF1ZXN0aW9uX2kiLCJxdWVzdGlvbiIsInVzZXJzZWxlY3Rpb25fYW5zd2Vyb25seSIsInVzZXJzZWxlY3Rpb25fd2l0aGV4cGxhbmF0aW9uIiwidXNlcnNlbGVjdGlvbl93aXRoZXhwbGFuYXRpb25xdWFsaXR5IiwiaW5zdHJ1Y3Rpb25faSIsImNvdW50X2V4aXRlZF9wYWdlIiwicmVnaXN0ZXJBbnN3ZXJPbmx5VXNlclNlbGVjdGlvbiIsInVzZXJfY2hvaWNlIiwiJCIsImF0dHIiLCJzaG93IiwicmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25Vc2VyU2VsZWN0aW9uIiwicmVnaXN0ZXJXaXRoRXhwbGFuYXRpb25RdWFsaXR5VXNlclNlbGVjdGlvbiIsInJlbW92ZUF0dHIiLCJuZXh0X2luc3RydWN0aW9ucyIsImluY3JlbWVudCIsInZhbCIsImhpZGUiLCJuZXh0X3F1ZXN0aW9uIiwiY2hpbGRyZW4iLCJlYWNoIiwiXyIsImVsIiwibGVuZ3RoIiwidGV4dCIsInRvRml4ZWQiLCJodG1sIiwidmlzdWFsX2ZpZGVsaXR5X2NvbmYiLCJNYXRoIiwicm91bmQiLCJ2aXN1YWxfY29udHJhc3RpdmVuZXNzX2NvbmYiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uIiwibG9nZ2VkX2RhdGEiLCJ1cmxQYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN0YXJ0T3ZlcnJpZGUiLCJnZXQiLCJVSURGcm9tVVJMIiwiZ2xvYmFsVGhpcyIsInVybF9kYXRhIiwiZW50cmllcyIsInJlc3VsdCIsImtleSIsInZhbHVlIiwicGFyYW1zVG9PYmplY3QiLCJ1aWQiLCJxdWV1ZV9pZCIsImZsb29yIiwicmFuZG9tIiwicGFkU3RhcnQiLCJVSURfbWF5YmUiLCJwcm9tcHQiLCJzdGFydHNXaXRoIiwiY29uc29sZSIsImxvZyIsImFzeW5jIiwiZ2V0SlNPTiIsIkRhdGUiLCJub3ciLCJsb2FkX2RhdGEiLCJjYXRjaCIsIl9lcnJvciIsInJlbG9hZCIsInRoZW4iLCJuZXdfZGF0YSIsInBhcnNlSW50IiwiYWxlcnRfYWN0aXZlIiwib252aXNpYmlsaXR5Y2hhbmdlIl0sInNvdXJjZVJvb3QiOiIifQ==